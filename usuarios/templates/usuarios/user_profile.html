
<div class="user-profile">
    <!-- Avatar con foto o letra -->
    <div class="user-avatar position-relative">
        {% if usuario_actual.foto_perfil %}
            <img src="{{ usuario_actual.foto_perfil.url }}" alt="Foto de perfil" 
                 style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;">
        {% else %}
            <div style="width: 50px; height: 50px; background: rgba(255,255,255,0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold;">
                {{ nombre_completo|first|upper }}
            </div>
        {% endif %}
        
        <!-- Botón para cambiar foto -->
        <div class="position-absolute" style="bottom: -5px; right: -5px;">
            <div class="dropdown">
                <button class="btn btn-sm btn-light rounded-circle" style="width: 25px; height: 25px; padding: 0;" data-bs-toggle="dropdown">
                    <i class="bi bi-camera" style="font-size: 12px;"></i>
                </button>
               <ul class="dropdown-menu dropdown-menu-end">
                    <li>
                        <label class="dropdown-item" for="foto-perfil-input" style="cursor: pointer;">
                            <i class="bi bi-upload me-2"></i>Subir foto
                        </label>
                        <form id="foto-perfil-form" action="{% url 'subir_foto_perfil' %}" method="post" enctype="multipart/form-data" style="display: none;">
                            {% csrf_token %}
                            <input type="file" id="foto-perfil-input" name="foto_perfil" accept="image/*" onchange="document.getElementById('foto-perfil-form').submit();">
                        </form>
                    </li>
                    {% if usuario_actual.foto_perfil %}
                    <li>
                        <a class="dropdown-item text-danger" href="{% url 'eliminar_foto_perfil' %}">
                            <i class="bi bi-trash me-2"></i>Eliminar foto
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>
    
    <div>
        <div style="font-weight: 600; margin-bottom: 5px;">{{ nombre_completo }}</div>
        <div style="font-size: 12px; opacity: 0.8;">Rol: {{ rol|capfirst }}</div>
        <div style="font-size: 12px; opacity: 0.8; margin-bottom: 15px;">{{ email }}</div>
        <a href="{% url 'logout' %}" class="logout-btn">
            <i class="bi bi-box-arrow-right me-1"></i>Cerrar Sesión
        </a>
    </div>
</div>
